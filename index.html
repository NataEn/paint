<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        padding: 0;
      }
      div {
        margin: 0;
        padding: 0;
        border: 1px solid black;
      }
      .container {
        width: 100vw;
        height: 100vh;
        border: 1px solid black;
        display: flex;
      }
      .canvas {
        position: relative;
        flex: 1;
        border: 2px solid black;
      }
      .colorPicker {
        width: 40px;
        display: flex;
        flex-direction: column;
        border: 2px solid black;
      }
      button {
        width: 30px;
        height: 30px;
        border: 1px solid red;
      }
    </style>
    <title>Document</title>
  </head>
  <body>
    <div class="container">
      <div class="canvas"></div>
      <div class="colorPicker">
        <button class="color" data-color="red"></button>
        <button class="color" data-color="green"></button>
        <button class="color" data-color="blue"></button>
        <button class="color" data-color="black"></button>
        <button class="color" data-color="yellow"></button>
        <button class="erasor" data-color="erasor">E</button>
        <button class="color" data-color="black"></button>
      </div>
    </div>
    <script>
      const canvas = document.querySelector(".canvas");
      const colors = document.querySelectorAll(".color");
      const container = document.querySelector(".container");
      const pixels = document.querySelectorAll(".pixel");
      const erasor = document.querySelector(".erasor");

      let color = "black";
      let erasorOn = false;

      for (let pixel of pixels) {
        pixel.addEventListener("mousedown", e => {
          console.log("mouseover the pixel");
          e.target.stopPropagation();
          canvas.removeChild(e.target);
        });
      }
      for (let colorB of colors) {
        if (colorB.dataset.color != "erasor") {
          colorB.style.background = colorB.dataset.color;
          colorB.addEventListener("click", e => {
            console.log(e.target);
            color = e.target.dataset.color;
          });
        }
      }
      const erase = () => {
        console.log("exited drawing state");
        if (erasorOn) {
          canvas.removeEventListener("mousemove", pixelDraw, true);
        }
      };
      erasor.addEventListener("click", e => {
        console.log(e.target);
        console.log("entered erasor");
        erasorOn = true;
        erase();
      });
      // erasor.addEventListener("click", e => {
      //   console.log(e.target);
      //   console.log("entered erasor");
      //   erasorOn = true;
      // });
      let toDraw = false;
      const draw = (x, y) => {
        let pixel = document.createElement("div");
        pixel.style.background = color;
        pixel.style.width = "10px";
        pixel.style.height = "10px";
        pixel.style.border = "1px solid black";
        pixel.style.position = "absolute";
        pixel.style.top = `${y}px`;
        pixel.style.left = `${x}px`;
        pixel.style.zIndex = "2";
        pixel.classList = "pixel";
        canvas.appendChild(pixel);
      };

      const pixelDraw = e => {
        if (toDraw) {
          draw(e.clientX, e.clientY);
        }
      };
      canvas.addEventListener("mousedown", e => {
        toDraw = true;
      });

      canvas.addEventListener("mousemove", pixelDraw, true);

      canvas.addEventListener("mouseup", e => {
        toDraw = false;
      });
    </script>
  </body>
</html>
